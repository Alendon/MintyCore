<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
    
    <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
      <title>Dependency Injection in the Game Engine </title>
      <meta name="viewport" content="width=device-width">
      <meta name="title" content="Dependency Injection in the Game Engine ">
      <meta name="generator" content="docfx 2.59.4.0">
      
      <link rel="shortcut icon" href="../../favicon.ico">
      <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/night-owl.min.css">
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css" integrity="sha384-EvBWSlnoFgZlXJvpzS+MAUEjvN7+gcCwH+qh7GRFOGgZO0PuwOFro7qPOJnLfe7l" crossorigin="anonymous">
      <link rel="stylesheet" href="../../styles/config.css">
      <link rel="stylesheet" href="../../styles/discord.css">
      <link rel="stylesheet" href="../../styles/singulink.css">
      <link rel="stylesheet" href="../../styles/main.css">
      <meta property="docfx:navrel" content="../../toc.html">
      <meta property="docfx:tocrel" content="../toc.html">
      
      
      
    </head>
    <body>
        <div class="top-navbar">
            <a class="burger-icon" onclick="toggleMenu()">
                <svg name="Hamburger" style="vertical-align: middle;" width="34" height="34" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M20 6H4V9H20V6ZM4 10.999H20V13.999H4V10.999ZM4 15.999H20V18.999H4V15.999Z"></path></svg>
            </a>

            
            <a class="brand" href="../../index.html">
              <img src="../../logo.svg" alt="" class="logomark">
              <span class="brand-title"></span>
            </a>        </div>

        <div class="body-content">
            <div id="blackout" class="blackout" onclick="toggleMenu()"></div>

            <nav id="sidebar" role="navigation">
                <div class="sidebar">
                    
                    <div>
                      <div class="mobile-hide">
                        
                        <a class="brand" href="../../index.html">
                          <img src="../../logo.svg" alt="" class="logomark">
                          <span class="brand-title"></span>
                        </a>  </div>
                    
                    
                      <div id="navbar">
                      </div>
                    </div>                    <div class="sidebar-item-separator"></div>
                        
                        <div id="sidetoggle">
                          <div id="sidetoc"></div>
                        </div>
                </div>
                <div class="footer">
                  
                  <strong><a href='https://dotnet.github.io/docfx/'>DocFX</a> + <a href='https://www.singulink.com'>Singulink</a> = ♥</strong>
                </div>            </nav>

            <main class="main-panel">

                <div role="main" class="hide-when-search">
                        
                        <div class="subnav navbar navbar-default">
                          <div class="container hide-when-search" id="breadcrumb">
                            <ul class="breadcrumb">
                              <li></li>
                            </ul>
                          </div>
                        </div>

                    <article class="content wrap" id="_content" data-uid="">
<h1 id="dependency-injection-in-the-game-engine">Dependency Injection in the Game Engine</h1>

<p>The Dependency Injection (DI) concept in this game engine primarily aims to abstract singletons, offering multiple
container levels and varied service types.</p>
<h2 id="container-levels">Container Levels</h2>
<p>Services and dependencies are registered and managed within the engine on several distinct levels:</p>
<ol>
<li><strong>Engine</strong>: Loaded directly at the start.</li>
<li><strong>Root Mods</strong>: Initialized after the engine is up and running.</li>
<li><strong>Game Mods</strong>: When a game session begins.</li>
</ol>
<h2 id="service-types-and-registration">Service Types and Registration</h2>
<p>Every type registered is named as &quot;unsafe-self&quot;. This facilitates a &quot;Service Locator&quot; pattern if required, although
typically, its use is not recommended.</p>
<p>The game engine also permits a single instance to be created for every mod. While the registry classes have not been
fully fleshed out, they are expected to exist as a single instance but remain accessible to the registration logic.</p>
<h2 id="registration-logic">Registration Logic</h2>
<p>Interestingly, this logic does not strictly adhere to the traditional DI pattern but more closely resembles a Service
Locator:</p>
<ul>
<li>A source generator scans all registry calls, generating a class filled with boilerplate code to register each object, grouped by registration type per mod.</li>
<li>The registration method in this class accepts the lifetime scope for the mod (either Root or Game Mods scope) and resolves the necessary Registry Class.</li>
<li>Every object then gets registered. Depending on the nature of the registration, a different approach is taken, such as with file, generic, or static property registrations.</li>
</ul>
<p>If classes aren’t registered, a new scope with the required class is created to resolve them. This way, the class can
access content from the DI container, like when accessing the Vulkan Swapchain Format, for instance.</p>
<h2 id="message-behavior">Message Behavior</h2>
<p>Messages in the engine also have a unique behavior as they essentially need to access content from the DI container. For
this, there&#39;s a separate DI container for the MessageHandler, containing all messages.</p>
<p>Upon receiving a message, the MessageHandler resolves the message and invokes the handle method. If there&#39;s a need to
send a message, a new message instance can be initiated through the MessageHandler.</p>
</article>
                </div>

            </main>
        </div>

        
        <script src="https://code.jquery.com/jquery-3.6.3.min.js" integrity="sha256-pvPw+upLPUjgMXY0G+8O0xUf+/Im1MZjXxxgOcBQBXU=" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.min.js" integrity="sha384-+sLIOodYLS7CIrQpBjl+C7nPvqq+FbNUBDunl/OZv93DB7Ln/533i8e/mZXLi/P+" crossorigin="anonymous"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
        <script type="text/javascript" src="../../styles/jquery.twbsPagination.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/jquery.mark.min.js"></script>
        <script type="text/javascript" src="../../styles/url.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/anchor-js@5.0.0/anchor.min.js"></script>
        <script type="text/javascript" src="../../styles/docfx.js"></script>
        <script type="text/javascript" src="../../styles/singulink.js"></script>
        <script type="text/javascript" src="../../styles/main.js"></script>    </body>
</html>
